<source>
  @type  forward
  port  24224
</source>

<filter **>
  @type record_transformer
  enable_ruby
  <record>
    severity ${'stdout' == record['source'] ? 'info' : 'err'}
    hostname ${tag_parts[0]}.${tag_parts[1]}
    app_name ${tag_parts[2]}.${tag_parts[3]}.${tag_parts[4]}
  </record>
</filter>

<match>
  @type syslog_tls
  host "#{ENV['SYSLOG_HOST']}"
  port "#{ENV['SYSLOG_PORT']}"
  idle_timeout 720

  # hostname static-hostname
  # facility SYSLOG

  # You can configure syslog headers to be picked from actual message
  # processed by plugin. If key is not provided '-' value will be sent
  # which is NIL by syslog specification.
  severity_key severity
  # facility_key RECORD_FACILITY_KEY
  hostname_key hostname
  app_name_key app_name
  # procid_key   procid
  # msgid_key ...

  # Fluent's standard formatting options are supported. Default is 'json'.
  # Example: For Docker logs sent to Papertrail, send only the log text:
  format single_value
  message_key log
</match>
